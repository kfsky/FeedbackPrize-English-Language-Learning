  0%|                                                                                                                                                                      | 0/3911 [00:00<?, ?it/s]Token indices sequence length is longer than the specified maximum sequence length for this model (565 > 512). Running this sequence through the model will result in indexing errors

100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3911/3911 [00:03<00:00, 1055.96it/s]
[2022-11-09 13:01:25] - max_len: 2048
[2022-11-09 13:01:25] - ========== fold: 0 training ==========
[2022-11-09 13:01:25] - FunnelConfig {
  "_name_or_path": "funnel-transformer/large",
  "activation_dropout": 0.0,
  "architectures": [
    "FunnelModel"
  ],
  "attention_dropout": 0.0,
  "attention_probs_dropout_prob": 0.0,
  "attention_type": "relative_shift",
  "block_repeats": [
    1,
    1,
    1
  ],
  "block_sizes": [
    8,
    8,
    8
  ],
  "d_head": 64,
  "d_inner": 4096,
  "d_model": 1024,
  "hidden_act": "gelu_new",
  "hidden_dropout": 0.0,
  "hidden_dropout_prob": 0.0,
  "initializer_range": 0.1,
  "initializer_std": null,
  "layer_norm_eps": 1e-09,
  "max_position_embeddings": 512,
  "model_type": "funnel",
  "n_head": 16,
  "num_decoder_layers": 2,
  "output_hidden_states": true,
  "pool_q_only": true,
  "pooling_type": "mean",
  "rel_attn_type": "factorized",
  "separate_cls": true,
  "transformers_version": "4.21.1",
  "truncate_seq": true,
  "type_vocab_size": 3,
  "vocab_size": 30522
}
Reinitializing Last 1 Layers ...
Traceback (most recent call last):
  File "/notebooks/code/exp050.py", line 788, in <module>
    main()
  File "/notebooks/code/exp050.py", line 726, in main
    _oof_df = train_loop(train, fold)
  File "/notebooks/code/exp050.py", line 551, in train_loop
    model = CustomModel(CFG, config_path=None, pretrained=True)
  File "/notebooks/code/exp050.py", line 330, in __init__
    for layer in self.model.encoder.layer[-cfg.reinit_layers:]:
  File "/usr/local/lib/python3.9/dist-packages/torch/nn/modules/module.py", line 1207, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'FunnelEncoder' object has no attribute 'layer'